# åç«¯æœåŠ¡è¯Šæ–­æŒ‡å—

## é—®é¢˜ç—‡çŠ¶
- å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯API
- é”™è¯¯ï¼š`ERR_CONNECTION_REFUSED`
- APIåœ°å€ï¼š`http://192.168.110.112:3002/api`
- ç«¯å£3002æœªç›‘å¬

## è¯Šæ–­æ­¥éª¤

### 1. æ£€æŸ¥åç«¯æœåŠ¡è¿›ç¨‹
```bash
ps aux | grep -E "node|nest" | grep -v grep
```

### 2. æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ netstat
netstat -tlnp | grep 3002

# æ–¹æ³•2ï¼šä½¿ç”¨ ss
ss -tlnp | grep 3002

# æ–¹æ³•3ï¼šä½¿ç”¨ lsof
lsof -i :3002
```

### 3. æ£€æŸ¥åç«¯æœåŠ¡æ—¥å¿—
```bash
cd backend
# æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
# æˆ–æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f logs/*.log
```

### 4. æ‰‹åŠ¨å¯åŠ¨åç«¯æœåŠ¡
```bash
cd backend
npm run start:dev
```

### 5. æ£€æŸ¥ç¯å¢ƒå˜é‡
```bash
cd backend
cat .env | grep -E "PORT|NODE_ENV|DATABASE"
```

## å¯èƒ½çš„åŸå› 

### 1. åç«¯æœåŠ¡æœªå¯åŠ¨
- **è§£å†³**ï¼šå¯åŠ¨åç«¯æœåŠ¡
  ```bash
  cd backend
  npm run start:dev
  ```

### 2. ç«¯å£è¢«å ç”¨
- **æ£€æŸ¥**ï¼š
  ```bash
  lsof -i :3002
  ```
- **è§£å†³**ï¼šåœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹æˆ–æ›´æ”¹ç«¯å£

### 3. æœåŠ¡å¯åŠ¨å¤±è´¥
- **æ£€æŸ¥æ—¥å¿—**ï¼šæŸ¥çœ‹å¯åŠ¨é”™è¯¯ä¿¡æ¯
- **å¸¸è§åŸå› **ï¼š
  - æ•°æ®åº“è¿æ¥å¤±è´¥
  - ç¯å¢ƒå˜é‡ç¼ºå¤±
  - ä¾èµ–æœªå®‰è£…

### 4. é˜²ç«å¢™é˜»æ­¢
- **æ£€æŸ¥**ï¼š
  ```bash
  sudo ufw status
  sudo iptables -L -n | grep 3002
  ```
- **è§£å†³**ï¼šå¼€æ”¾ç«¯å£æˆ–å…³é—­é˜²ç«å¢™ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰

## å¿«é€Ÿä¿®å¤

### æ–¹æ¡ˆ1ï¼šé‡å¯åç«¯æœåŠ¡
```bash
cd /www/wwwroot/vioflow-A/vioflow_A1s-1/backend
# åœæ­¢ç°æœ‰è¿›ç¨‹
pkill -f "nest start"
# å¯åŠ¨æœåŠ¡
npm run start:dev
```

### æ–¹æ¡ˆ2ï¼šæ£€æŸ¥å¹¶ä¿®å¤é…ç½®
```bash
cd backend
# æ£€æŸ¥.envæ–‡ä»¶
cat .env

# ç¡®ä¿åŒ…å«ï¼š
# PORT=3002
# NODE_ENV=development
# DATABASE_URL=...
```

### æ–¹æ¡ˆ3ï¼šä½¿ç”¨PM2ç®¡ç†ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
```bash
npm install -g pm2
cd backend
pm2 start npm --name "vioflow-backend" -- run start:dev
pm2 logs vioflow-backend
```

## éªŒè¯ä¿®å¤

### 1. æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨
```bash
curl http://localhost:3002/api/health
# æˆ–
curl http://192.168.110.112:3002/api/health
```

### 2. æ£€æŸ¥å‰ç«¯è¿æ¥
- æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°
- æŸ¥çœ‹ `ğŸŒ API Base URL:` æ—¥å¿—
- å°è¯•ç™»å½•ï¼Œæ£€æŸ¥ç½‘ç»œè¯·æ±‚

## é¢„é˜²æªæ–½

1. **ä½¿ç”¨è¿›ç¨‹ç®¡ç†å·¥å…·**ï¼ˆå¦‚PM2ï¼‰
2. **é…ç½®è‡ªåŠ¨é‡å¯**
3. **ç›‘æ§æœåŠ¡çŠ¶æ€**
4. **è®¾ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹**


